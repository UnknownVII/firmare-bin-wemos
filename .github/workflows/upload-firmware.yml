name: Firmware Release

on:
  push:
    branches:
      - master

jobs:
  release:
    name: 🚀 Upload firmware to GitHub Release 1
    runs-on: ubuntu-latest

    permissions:
      contents: write  # Needed to create release and upload assets

    steps:
      - name: 📥 Checkout repository
        uses: actions/checkout@v3

      - name: 🏷️ Create Release and Upload Firmware
        uses: softprops/action-gh-release@v2
        with:
          name: Firmware v${{ github.run_number }}
          tag_name: v${{ github.run_number }}
          files: build/esp8266.esp8266.d1_mini_clone/*.bin
          generate_release_notes: true
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
